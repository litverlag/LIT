/**
 All functions relevant for the input Views
 */


function textbox_info_submit(){
  $( "input[type|='submit']").click(function(){
    var versand_zur_ueber = $("#gprod_titelei_versand_an_zur_ueberpf");
    if (versand_zur_ueber.val() == "<%= I18n.t 'textfield_messages.versand_an' %>"){
      versand_zur_ueber.val("An den Autor gesendet");
    }
  });
};



function textbox_info(){
  var versand_zur_ueber = $("#gprod_titelei_versand_an_zur_ueberpf");
  if (versand_zur_ueber.val() == "<%= I18n.t 'textfield_messages.versand_an' %>"){
    versand_zur_ueber.focus(function() {
      this.value = "";
    });
    versand_zur_ueber.focusout(function() {
      if (this.value == ""){
        this.value = "<%= I18n.t 'textfield_messages.versand_an' %>";
      }
    });
  }


};


//Dieser Teil wird benutzt um die Standartfehlernachricht der HTML5-validierung zu ändern
function number_field_error_msg(){
  function not_a_number() {
    var textfield = $(this).get(0);

    // 'setCustomValidity not only sets the message, but also marks
    // the field as invalid. In order to see whether the field really is
    // invalid, we have to remove the message first
    textfield.setCustomValidity('');

    if (!textfield.validity.valid) {
      textfield.setCustomValidity("<%=  I18n.t 'flash_notice.is_not_a_number'%>");
    }};
  $( "input[type|='number']").on('change invalid', not_a_number);
};



//Das Datumformat des Datepickers ändern
function datepicker_format(){
  $(".datepicker").change(function (){
    this.value = moment(this.value).format("DD.MM.YYYY");

  });
};


//Autocomplete für die Autorennamen beim Erstellen von Projekten
function autocomplete_names(){$( "#name_autocomplete" ).autocomplete({
  <% autor_name_list = []%>
  <% Autor.all.each do |autor| %>
  <% autor_name_list.append autor.name %>
  <%end%>
  source: <%= raw autor_name_list.as_json %>
});
};



function slider(){
  $( "h3").click(function( event ) {
    $(event.target).parent().find("table").slideToggle(100);

  });
};



function check_box_lek() {
  if($("#admin_user_department_ids_10").prop('checked')){
    $("#lektor_select_box").show();
    for (i=1;i<10;i++) {
      $( "#admin_user_department_ids_" + i.toString() ).prop( "disabled", true);
      $( "#admin_user_department_ids_" + i.toString() ).prop( "checked", false);
    }

    // on change lektor checkbox
    $("#admin_user_department_ids_10").change(check_box_lek);

    // on change other department checkbox
    $("#admin_user_department_ids_1, #admin_user_department_ids_2, #admin_user_department_ids_3, " +
        "#admin_user_department_ids_4, #admin_user_department_ids_5, #admin_user_department_ids_6, " +
        "#admin_user_department_ids_7, #admin_user_department_ids_8, "+
        "#admin_user_department_ids_9").change(check_box_dep);
  } else {
    $("#lektor_select_box").hide();
    $("#lektor_select_box").find("option:selected").prop("selected", false);
    for (i=1;i<10;i++) {
      $( "#admin_user_department_ids_" + i.toString() ).prop( "disabled", false);
    }
  }
};

function check_box_frei() {
  if($("input[name='gprod[satzproduktion]']").prop("checked")){
      $( "input[name='status[freigabe_titelei]']").prop( "disabled", true);
      $( "input[name='status[freigabe_umschlag]']").prop( "disabled", true);
      $( "input[name='status[freigabe_preps]']").prop( "disabled", true);
      $( "input[name='status[freigabe_titelei]']" ).prop( "checked", false);
      $( "input[name='status[freigabe_umschlag]']" ).prop( "checked", false);
      $( "input[name='status[freigabe_preps]']" ).prop( "checked", false);
   }else{
      $( "input[name='status[freigabe_final]']").prop( "disabled", true);
      $( "input[name='status[freigabe_final]']" ).prop( "checked", false);
   }
    $("input[name='gprod[satzproduktion]']").change(check_box_frei);  
   
};

function check_box_dep() {
  var all_unchecked = true;
  for (i=1;i<10;i++) {
    if($("#admin_user_department_ids_" + i.toString() ).prop('checked')) {
      $( "#admin_user_department_ids_10" ).prop( "disabled", true);
      $( "#admin_user_department_ids_10" ).prop( "checked", false);
      $("#lektor_select_box").hide();
      all_unchecked = false;
    }
  }
  if (all_unchecked) {
    $( "#admin_user_department_ids_10" ).prop( "disabled", false);
  }
};

function admin_users_input(){
  // on change lektor checkbox
  $("#admin_user_department_ids_10").change(check_box_lek);

// on change other department checkbox
  $("#admin_user_department_ids_1, #admin_user_department_ids_2, #admin_user_department_ids_3, " +
      "#admin_user_department_ids_4, #admin_user_department_ids_5, #admin_user_department_ids_6, " +
      "#admin_user_department_ids_7, #admin_user_department_ids_8, "+
      "#admin_user_department_ids_9").change(check_box_dep);
};

